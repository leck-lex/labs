function t(t){return t&&t.__esModule?t.default:t}class e{static API_BASE_URL="api/";static EVENT_ITEM_UPDATE="item-update";static EVENT_ITEM_CREATE="item-create";static EVENT_ITEM_DELETE="item-delete"}class s{static async getAllItems(){return await this.#t("GET")}static async createItem(t){return await this.#t("POST","",t)}static async updateItem(t,e){return await this.#t("PATCH",t,e)}static async deleteItem(t){return await this.#t("DELETE",t)}static async#t(t,s="",i){const n={method:t};i&&(n.headers={"Content-Type":"application/json"},n.body=JSON.stringify(i));const a=await fetch(e.API_BASE_URL+s,n);if(a.ok)return 204!==a.status?a.json():{};throw new Error(a.status+" "+a.statusText)}}class i{#e=[];constructor(t){this.id,this.tag,this.options,this.populate(t)}set classList(t){"string"==typeof t&&(t=t.split(" ")),this.#e=[...this.#e,...t]}get classList(){return this.#e}populate(t){t&&Object.assign(this,t)}}class n{#s;#i;constructor(t){this.config=t||new i,this.validateConfig(),this.populateFromConfig()}set id(t){this.element.id=t}get id(){return this.element.id}set element(t){this.#i=t}get element(){return this.#i}set config(t){this.#s=t}get config(){return this.#s}get defaults(){return{tag:"div",id:"",classList:""}}render(t){this.element.innerHTML=t}appendTo(t){return t.appendChild(this.element),this}prependTo(t){return element.prependChild(this.element),this}validateConfig(){this.config.tag=this.config.tag||this.defaults.tag,this.config.id=this.config.id||this.defaults.id,this.config.classList=this.defaults.classList}populateFromConfig(){this.element=document.createElement(this.config.tag),this.id=this.config.id,this.element.classList.add(...this.config.classList)}destroy(){this.element.remove()}}class a extends n{constructor(){super(),this.render()}get defaults(){return{tag:"div",id:"loader-spinner",classList:"todo__header-loader"}}render(){super.render('<svg class="loader__spinner" viewBox="0 0 50 50"><circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle></svg>')}show(){this.element.querySelector(".loader__spinner").classList.add("show")}hide(t=0){return new Promise((e=>{setTimeout((()=>{this.element.querySelector(".loader__spinner").classList.remove("show"),e()}),t)}))}}class r extends n{#n;#a;#r;#o;#l;#d;#h=!1;#c;constructor(){super(),this.render()}get defaults(){return{tag:"header",id:"todo-header",classList:"todo__header"}}render(){super.render(t('<h1 class="todo__header-heading">Todo</h1><form> <input type="text" name="title" id="title" required> </form><button class="icon-button--light material-icons-round md-48 todo__header-btn-save" title="Save"> save </button><button class="icon-button--light material-icons-round md-48 todo__header-btn-create" title="Add task"> add_circle </button>')),this.#o=this.element.querySelector("form"),this.#o.addEventListener("submit",(t=>{t.preventDefault(),this.#u()})),this.#l=this.element.querySelector("input"),this.#a=this.element.querySelector(".todo__header-btn-create"),this.#a.addEventListener("click",(()=>this.#m())),this.#r=this.element.querySelector(".todo__header-btn-save"),this.#r.addEventListener("click",(()=>this.#o.requestSubmit())),this.#d=this.element.querySelector(".todo__header-heading"),this.#n=(new a).appendTo(this.element),this.#n.show(),document.addEventListener("click",(t=>{!t.composedPath().includes(this.element)&&this.#h&&this.#m()}))}enable(){this.#n.hide(500).then((()=>this.#a.classList.add("show")))}#u(){const t=new CustomEvent(e.EVENT_ITEM_CREATE,{detail:{title:this.#l.value,done:!1}});document.dispatchEvent(t),this.#l.value="",this.#m()}#m(){this.#h=!this.#h,this.#h?(this.#a.setAttribute("title","Cancel"),this.#c=setTimeout((()=>{this.#l.focus()}),300)):(this.#a.setAttribute("title","Add task"),clearTimeout(this.#c)),this.#l.classList.toggle("show"),this.#a.classList.toggle("mode-cancel"),this.#r.classList.toggle("show"),this.#d.classList.toggle("hide")}}class o extends n{#p;#o;#g;#E;#v;#b;#_;#r;#f=!1;#L;#T;constructor(t){super(t),this.render()}get defaults(){return{tag:"li",id:"todo-list-item",classList:"todo__list-item"}}set title(t){this.#g.value=t}get title(){return this.#g.value}set done(t){this.#p=t,this.#E.innerText=t?"check_circle_outline":"radio_button_unchecked",this.#p?this.#g.classList.add("done"):this.#g.classList.remove("done")}get done(){return this.#p}render(){super.render(t('<button class="icon-button--secondary material-icons-round md-36 todo__list-item-check" title="Task status"> radio_button_unchecked </button><form><input id="title" name="title" required disabled></form><div class="todo__list-item-menu"> <button class="icon-button--grey material-icons-round md-36 todo__list-item-btn-save" title="Save"> save </button> <button class="icon-button--grey material-icons-round md-36 todo__list-item-btn-delete" title="Delete"> remove_circle_outline </button> </div><button class="icon-button--grey material-icons-round md-36 todo__list-item-btn-menu" title="Toggle menu"> more_horiz </button>'));const e=".todo__list-item-";this.#o=this.element.querySelector("form"),this.#o.addEventListener("submit",(t=>{t.preventDefault(),this.#L=!0,this.#I(),this.#S({title:this.title},{title:this.#T})})),this.#g=this.element.querySelector("input"),this.#E=this.element.querySelector(e+"check"),this.#E.addEventListener("click",this),this.#v=this.element.querySelector(e+"menu"),this.#b=this.element.querySelector(e+"btn-menu"),this.#b.addEventListener("click",this),this.#_=this.element.querySelector(e+"btn-delete"),this.#_.addEventListener("click",this),this.#r=this.element.querySelector(e+"btn-save"),this.#r.addEventListener("click",this),document.addEventListener("click",this.#k.bind(this))}populate(t){Object.assign(this,t)}handleEvent(t){switch(!0){case t.target===this.#E:this.#S({done:!this.done},{done:this.done});break;case t.target===this.#r:this.#o.requestSubmit();break;case t.target===this.#_:this.#y();break;case t.target===this.#b:this.#I()}}#k(t){!t.composedPath().includes(this.element)&&this.#f&&this.#I()}#I(){this.#f=!this.#f,this.#g.disabled=!this.#f,this.#f?(this.#T=this.title,this.#L=!1,this.#g.focus()):this.#L||(this.title=this.#T),this.#v.classList.toggle("show"),this.#b.classList.toggle("selected")}#S(t,s){const i=new CustomEvent(e.EVENT_ITEM_UPDATE,{detail:{id:this.id,props:t,prevProps:s}});document.dispatchEvent(i)}#y(){const t=new CustomEvent(e.EVENT_ITEM_DELETE,{detail:this});document.dispatchEvent(t)}destroy(){this.#E.removeEventListener("click",this),this.#b.removeEventListener("click",this),this.#_.removeEventListener("click",this),this.#r.removeEventListener("click",this),document.removeEventListener("click",this.#k.bind(this)),super.destroy()}}class l extends n{#w=[];constructor(){super()}get defaults(){return{tag:"ul",id:"todo-list",classList:"todo__list"}}addItem(t){const e=new o;return e.populate(t),e.appendTo(this.element),this.#w.push(e),e}updateItem(t,e){this.#w.find((e=>e.id===t)).populate(e)}deleteItem(t){const e=this.#w.findIndex((e=>e.id===t));if(-1!==e){this.#w.splice(e,1)[0].destroy()}}}class d extends n{#C;#M;constructor(){super(),this.render()}get defaults(){return{tag:"div",id:"todo",classList:"todo"}}render(){this.#C=new r,this.#C.appendTo(this.element),this.#M=new l,this.#M.appendTo(this.element),document.addEventListener(e.EVENT_ITEM_CREATE,(t=>this.#q(t.detail))),document.addEventListener(e.EVENT_ITEM_UPDATE,(t=>this.#D(t.detail.id,t.detail.props,t.detail.prevProps))),document.addEventListener(e.EVENT_ITEM_DELETE,(t=>this.#A(t.detail))),s.getAllItems().then((t=>{this.#C.enable(),this.#O(t.items)})).catch((t=>console.error(t)))}#q(t){s.createItem(t).then((t=>this.#M.addItem(t))).catch((t=>{console.error(t)}))}#D(t,e,i){this.#M.updateItem(t,e),s.updateItem(t,e).catch((e=>{this.#M.updateItem(t,i),console.error(e)}))}#A(t){t.element.classList.add("hide"),s.deleteItem(t.id).then((()=>this.#M.deleteItem(t.id))).catch((e=>{t.element.classList.remove("hide"),console.error(e)}))}#O(t){t.forEach((t=>this.#M.addItem(t)))}}class h{static#V;static get instance(){return this.#V||(this.#V=new h),this.#V}constructor(){}run(){(new d).appendTo(document.querySelector("main"))}}h.instance.run();
//# sourceMappingURL=index.2976ba40.js.map
