class e{static GAME={USER:"plsyer_user",COMPUTER:"player_wopr",WIN:"win",LOSE:"lose",WAR:"war"};static API={BASE_URL:"https://deckofcardsapi.com/api/deck",DECK_TOP:"",DECK_BOTTOM:"bottom/",DECK_RANDOM:"random/"}}class t{#e;constructor(){}async getNewDeck(e=1){const t=await this.#t(`/new/shuffle/?deck_count=${e}`);this.#e=t.deck_id}drawFromDeck(t,a=e.API.DECK_TOP){return this.#t(`/${this.#e}/draw/${a}?count=${t}`)}drawFromPile(t,a=1,s=e.API.DECK_BOTTOM){return this.#t(`/${this.#e}/pile/${t}/draw/${s}?count=${a}`)}addToPile(e,t){return this.#t(`/${this.#e}/pile/${e}/add/?cards=${this.#a(t)}`)}#t(t){return new Promise(((a,s)=>{console.log("%c[API Call]"+t,"color: grey"),fetch(e.API.BASE_URL+t,{method:"GET"}).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()})).then((e=>{console.log("%c[API Data]","color: grey",e),a(e)})).catch((e=>s(e)))}))}#a(e){return e.map((e=>e.code)).join(",")}}class a{constructor(e){this.code,this.image,this.images={svg:"",png:""},this.suit,this.value,Object.assign(this,e)}get valueByNumber(){if(!Number.isNaN(Number.parseInt(this.value)))return+this.value;switch(this.value.toUpperCase()){case"JACK":return 11;case"QUEEN":return 12;case"KING":return 13;case"ACE":return 14}}}class s{constructor(e){this.id=e,this.card,this.ramaining,this.state,this.endState}}class r{#s;#r=[];constructor(){this.#c()}#c(){this.#s=new t}async setupNewGame(){try{await this.#s.getNewDeck(),await this.#i(e.GAME.USER),await this.#i(e.GAME.COMPUTER),console.log("New game ready")}catch(e){console.error(e)}}async playRound(){console.log("Play round");try{const t=await this.#n(new s(e.GAME.USER)),a=await this.#n(new s(e.GAME.COMPUTER));console.log("user.card: "+t.card.valueByNumber),console.log("computer.card: "+a.card.valueByNumber),t.card.valueByNumber===a.card.valueByNumber?(console.log("WAR"),t.state=a.state=e.GAME.WAR,await this.#n(t),await this.#n(a)):(console.log("WIN / LOSE"),t.card.valueByNumber>a.card.valueByNumber?(t.state=e.GAME.WIN,a.state=e.GAME.LOSE):(t.state=e.GAME.LOSE,a.state=e.GAME.WIN)),console.log("user: ",t),console.log("computer:",a)}catch(e){console.error(e)}}async#i(e){const t=await this.#s.drawFromDeck(26);await this.#s.addToPile(e,t.cards)}async#n(t){const s=await this.#s.drawFromPile(t.id),r=new a(s.cards[0]);return t.state!==e.GAME.WAR&&(t.card=r),this.#r.push(r),t.remaining=s.piles[t.id].remaining,t}}class c{static#o;static get instance(){return this.#o||(this.#o=new c),this.#o}#d;constructor(){}get gameService(){return this.#d}run(){document.querySelector("main").insertAdjacentElement("afterbegin",document.createElement("h1")).innerHTML="Week 41 Lab 10 Fetch (Deck of Cards)",this.#d=new r;const e=document.createElement("button");e.innerText="Log New Game",e.classList.add("generic-button"),e.addEventListener("click",(()=>{t.disabled=!0,this.#d.setupNewGame().then((()=>t.disabled=!1))})),document.querySelector("main").appendChild(e);const t=document.createElement("button");t.style.marginLeft="10px",t.innerText="Log Play Round",t.classList.add("generic-button"),t.disabled=!0,t.addEventListener("click",(()=>this.#d.playRound())),document.querySelector("main").appendChild(t)}}c.instance.run();
//# sourceMappingURL=index.3456b5cd.js.map
